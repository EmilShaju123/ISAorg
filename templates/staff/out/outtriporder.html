{% extends 'staffindex.html' %}
{% block content %}
<form method="post">
    {% csrf_token %}
    <div class="container">
        <div class="page-inner">
            <div class="page-header">
              <ul class="breadcrumbs mb-3">
                <li class="nav-home"></li>
                <li class="separator">
                  <i class="icon-arrow-right"></i>
                </li>
              </ul>
            </div>
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
            <div class="row">
              <div class="col-md-12">
                <div class="card">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-md-6 col-lg-4">
                          <h3 class="fw-bold mb-3">Trip Order</h3>
                      </div>
                    </div>

                      <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="code"><b>Code <span style="color: red;">*</span></b></label>
                                <input type="text" class="form-control" name="code" id="code" list="codeList"
                                       oninput="this.value = this.value.replace(/[\/\\]/g, '').toUpperCase()" style="text-transform: uppercase" required>
                                <datalist id="codeList">
                                {% for truck in d3 %}
                                    <option value="{{ truck.code }}">{{ truck.code }}</option>
                                {% endfor %}
                                </datalist>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="dat"><b>Date  <span style="color: red;">*</span></b></label>
                                <input type="date" value="{{today}}" class="form-control" name="dat" id="dat" required/>
                            </div>
                        </div>
                      </div>

                      <div class="row">
                        <div class="col-md-6">
                            <div class="form-group" >
                                <label for="party"><b>Party  <span style="color: red;">*</span></b></label>
                                <select class="form-control" name="party" id="party" required>
                                    {% for i in d2 %}
                                    <option value="{{i.party}}">{{i.short}}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group" >
                                <label for="place"><b>Place  <span style="color: red;">*</span></b></label>
                                <select class="form-control" name="place" id="place" required>
                                    {% for i in d %}
                                    <option>{{i.place}}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                      </div>

                      <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="trans"><b>Transporter <span style="color: red;">*</span></b></label>
                                <input type="text" class="form-control" name="trans" id="trans" list="transList" oninput="this.value = this.value.replace(/[\/\\]/g, '').toUpperCase()" required>
                                <datalist id="transList">
                                {% for t in trans %}
                                 <option value="{{ t.trans }}">{{ t.trans }}</option>
                                {% endfor %}
                                </datalist>
                            </div>
                        </div>
                          <div class="col-md-6">
                            <div class="form-group" >
                                <label for="driver"><b>Driver</b></label>
                                <select class="form-control" name="driver" id="driver">
                                    <option>OTHER</option>
                                </select>
                            </div>
                        </div>
                      </div>

                      <div class="row">
                        <div class="col-md-6">
                            <div class="form-group" >
                                <label for="dis"><b>Diesel Advance</b></label>
                                <input type="number" class="form-control" name="dis" id="dis">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group" >
                                <label for="disqnt"><b>Diesel Qnt</b></label>
                                <input type="number" class="form-control" step="0.01" name="disqnt" id="disqnt">
                            </div>
                        </div>
                      </div>

                      <div class="row">
                        <div class="col-md-6">
                            <div class="form-group" >
                                <label for="trip"><b>Type  <span style="color: red;">*</span></b></label>
                                <select class="form-control" name="trip" id="trip" required>
                                    {% for i in d1 %}
                                    <option>{{i.trip}}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group" >
                                <label for="feet"><b>Feet</b></label>
                                <select class="form-control" name="feet" id="feet">
                                    <option>20</option>
                                    <option>40</option>
                                </select>
                            </div>
                        </div>

                      </div>
                      <div class="row">
                        <div class="col-md-6">
                            <div class="form-group" >
                                <label for="hire"><b>Hire</b></label>
                                <input type="number" class="form-control" name="hire" id="hire">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group" >
                                <label for="halt"><b>Halt</b></label>
                                <input type="number" class="form-control" name="halt" id="halt">
                            </div>
                        </div>
                      </div>

                      <div class="row">
                        <div class="col-md-6">
                            <div class="form-group" >
                                <label for="buy"><b>Buy</b></label>
                                <input type="number" class="form-control" name="buy" id="buy">
                            </div>
                        </div>
                          <div class="col-md-6">
                            <div class="form-group" >
                                <label for="outadv"><b>Outside Advance</b></label>
                                <input type="number" class="form-control" name="outadv" id="outadv">
                            </div>
                        </div>
                      </div>
                      <div class="row">
                          <div class="col-md-6">
                            <div class="form-group" >
                                <label for="cont"><b>Container </b></label>
                                <input type="text" class="form-control" name="cont" id="cont"
                                       oninput="this.value = this.value.toUpperCase().replace(/\s/g, '')">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group" >
                                <label for="bno"><b>Bill No</b></label>
                                <input type="number" class="form-control" name="bno" id="bno">
                            </div>
                        </div>
                      </div>
                      <div class="card-action">
                          <div class="row">
                            <div class="col-md-2">
                                <div class="form-group" >
                                    <button type="submit" name="bill" class="btn btn-success">Submit</button>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group" >
                                    <button type="reset" class="btn btn-danger">Cancel</button>
                                </div>
                            </div>
                          </div>
                      </div>
                  </div>
                </div>
              </div>
            </div>
        </div>
    </div>
</form>
<script>
    const trucks = [
        {% for truck in d3 %}
            {
                code: "{{ truck.code }}",
                trans: "{{ truck.trans }}",
                feet: "{{ truck.feet }}"
            },
        {% endfor %}
    ];

    const codeInput = document.getElementById('code');
    const transInput = document.getElementById('trans');
    const feetSelect = document.getElementById('feet');

    codeInput.addEventListener('input', function() {
        const selectedCode = codeInput.value;
        const truck = trucks.find(truck => truck.code === selectedCode);
        if (truck) {
            transInput.value = truck.trans;
            Array.from(feetSelect.options).forEach(option => {
                if (option.text === truck.feet) {
                    option.selected = true;
                }
            });
        } else {
            transInput.value = '';
            feetSelect.selectedIndex = 0;
        }
    });
</script>
{% endblock %}